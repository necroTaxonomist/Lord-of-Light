<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>leftBar = instance_create(8,16,obj_health_bar);
rightBar = instance_create(room_width-80-8,16,obj_health_bar);

curRound = 1;

global.beginTimer = 180;

p1 = instance_create(-global.SCREEN_WIDTH/4,
                     global.GROUND_HEIGHT + .5,
                     global.p1Char);
p1.controller = global.p1Ctrl;
fighter_set_health_bar(p1, leftBar);

p2 = instance_create(global.SCREEN_WIDTH/4,
                     global.GROUND_HEIGHT + .5,
                     global.p2Char);
p2.controller = global.p2Ctrl;
fighter_set_health_bar(p2, rightBar);

p1.target = p2;
p2.target = p1;

if (global.p1Char == global.p2Char)
    p2.darkened = true;

wins[0] = 0;
wins[1] = 0;
roundWinner = 0;

paused = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.beginTimer &gt; -60)
    global.beginTimer -= 1;

if (global.beginTimer == 179)
{
    play_music();
}
    
if (global.beginTimer == 170)
{
    if (curRound == 1)
        audio_play_sound(snd_round1, 0, false);
    else if (curRound == 2)
        audio_play_sound(snd_round2, 0, false);
    else if (curRound == 3)
        audio_play_sound(snd_round3, 0, false);
}

if (global.beginTimer == 1)
{
    audio_play_sound(snd_fight, 0, false);
}

if (global.deathTimer &gt; 0)
{
    global.deathTimer -= 1;
    if (global.deathTimer == 15)
        instance_create(0,0,obj_screen_darken);
}
else if (global.deathTimer == 0)
{
    curRound += 1;
    
    if (wins[0] &gt;= 2 || wins[1] &gt;= 2)
    {
        global.deathTimer = -1;
        roundWinner = 0;
        room_goto_previous();
    }
    else
    {
        fighter_reset_state(p1);
        fighter_reset_state(p2);
        
        p1.x = -global.SCREEN_WIDTH/4;
        p1.y = global.GROUND_HEIGHT;
        
        p2.x = global.SCREEN_WIDTH/4;
        p2.y = global.GROUND_HEIGHT;
        
        fighter_set_health_bar(p1, leftBar);
        fighter_set_health_bar(p2, rightBar);
        
        global.beginTimer = 180;
        global.deathTimer = -1;
        
        roundWinner = 0;
    }
}
else if (global.deathTimer == -1)
{
    if (leftBar.curValue &lt;= 0)
    {
        wins[1] += 1;
        roundWinner = 2;
        global.deathTimer = 180;
        stop_music();
    }
    
    if (rightBar.curValue &lt;= 0)
    {
        wins[0] += 1;
        roundWinner = 1;
        global.deathTimer = 180;
        stop_music();
    }
}

if (p1.controller.pause)
{
    if (paused == 0)
    {
        paused = 1;
        instance_deactivate_object(p1);
        instance_deactivate_object(p2);
    }
    else if (paused == 1)
    {
        paused = 0;
        instance_activate_object(p1);
        instance_activate_object(p2);
    }
}

if (p2.controller.pause)
{
    if (paused == 0)
    {
        paused = 2;
        instance_deactivate_object(p1);
        instance_deactivate_object(p2);
    }
    else if (paused == 2)
    {
        paused = 0;
        instance_activate_object(p1);
        instance_activate_object(p2);
    }
}

if (paused == 1 &amp;&amp; p1.controller.goback)
{
    stop_music();
    room_goto_previous();
}
else if (paused == 2 &amp;&amp; p2.controller.goback)
{
    stop_music();
    room_goto_previous();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_rectangle(0,0,room_width,64,false);

draw_sprite(spr_round, 0, room_width/2, 0);
draw_sprite(spr_round_number, curRound, room_width/2, 16);

draw_sprite(spr_name_small, p1.characterIndex, 8, 3);
draw_sprite(spr_name_small, p2.characterIndex + 6, room_width - 81, 3);

for (i = 0; i &lt; wins[0]; i++)
{
    draw_sprite(spr_w, 0, room_width/2-28, 32 + 20*i);
}

for (i = 0; i &lt; wins[1]; i++)
{
    draw_sprite(spr_w, 0, room_width/2+28, 32 + 20*i);
}

if (paused != 0)
{
    draw_sprite(spr_pause, 0, room_width/2, room_height/2);
    exit;
}

if (global.beginTimer &gt; 0 &amp;&amp; floor(global.beginTimer/30) mod 2 == 1)
    draw_sprite(spr_prepare, 0, room_width/2, room_height/2);

if (global.beginTimer &lt;= 0 &amp;&amp; global.beginTimer &gt; -60)
    draw_sprite(spr_go, 0, room_width/2, room_height/2);

if ((wins[0] &gt;= 2 || wins[1] &gt;= 2)
    &amp;&amp; global.deathTimer &gt;= 0
    &amp;&amp; global.deathTimer &lt; 120
    &amp;&amp; roundWinner &gt; 0)
{
    draw_sprite(spr_win, roundWinner-1, room_width/2, room_height/2);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="52">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.playMusic)
    stop_music();

if (global.badMidis)
    global.badMidis = false;
else
    global.badMidis = true;

if (global.playMusic)
    play_music();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="51">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.playMusic)
{
    global.playMusic = false;
    stop_music();
}
else
{
    global.playMusic = true;
    play_music();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="50">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>stop_music();
room_goto_previous();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="49">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.seeHitboxes)
    global.seeHitboxes = false;
else
    global.seeHitboxes = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
